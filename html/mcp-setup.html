<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MCP SuperAssistant Setup</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap');

    :root {
      /* Premium Dark Palette (Default) */
      --bg-root: #0f0f13;
      --glass-surface: rgba(20, 20, 25, 0.95);
      --glass-border: rgba(255, 255, 255, 0.08);
      --glass-highlight: rgba(255, 255, 255, 0.05);

      --text-primary: #ffffff;
      --text-secondary: #9ca3af;
      --text-tertiary: #6b7280;

      --accent-primary: #818cf8;
      --accent-glow: rgba(129, 140, 248, 0.4);
      --accent-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);

      --input-bg: rgba(255, 255, 255, 0.03);
      --input-border: rgba(255, 255, 255, 0.08);

      --danger-color: #f43f5e;
      --success-color: #22c55e;

      --radius-xl: 24px;
      --radius-lg: 16px;
      --radius-md: 12px;
      --radius-sm: 8px;

      --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
      --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.15);

      --ease-elastic: cubic-bezier(0.34, 1.56, 0.64, 1);
      --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);

      /* Component Variables */
      --item-bg: rgba(255, 255, 255, 0.02);
      --item-hover-bg: rgba(255, 255, 255, 0.04);
      --button-bg: rgba(255, 255, 255, 0.05);
      --button-hover-bg: rgba(255, 255, 255, 0.08);
      --chip-bg: rgba(129, 140, 248, 0.1);
      --chip-border: rgba(129, 140, 248, 0.2);
    }

    html.light-mode {
      --bg-root: #f1f5f9;
      --glass-surface: rgba(255, 255, 255, 0.85);
      --glass-border: rgba(0, 0, 0, 0.08);
      --glass-highlight: rgba(255, 255, 255, 0.8);

      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-tertiary: #94a3b8;

      --accent-primary: #6366f1;
      --accent-glow: rgba(99, 102, 241, 0.25);
      --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);

      --input-bg: rgba(0, 0, 0, 0.04);
      --input-border: rgba(0, 0, 0, 0.1);

      --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);

      --item-bg: rgba(255, 255, 255, 0.6);
      --item-hover-bg: rgba(255, 255, 255, 0.9);
      --button-bg: rgba(0, 0, 0, 0.04);
      --button-hover-bg: rgba(0, 0, 0, 0.08);
      --chip-bg: rgba(99, 102, 241, 0.1);
      --chip-border: rgba(99, 102, 241, 0.2);
    }

    html.light-mode body::before {
      background: radial-gradient(circle at 10% 10%, rgba(99, 102, 241, 0.08), transparent 60%),
        radial-gradient(circle at 90% 90%, rgba(168, 85, 247, 0.08), transparent 60%);
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      overflow-x: hidden;
      max-width: 100vw;
      font-family: 'Outfit', sans-serif;
      background: var(--bg-root);
      color: var(--text-primary);
      user-select: none;
      -webkit-font-smoothing: antialiased;
    }

    /* Background Effects */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      background: radial-gradient(circle at 10% 10%, rgba(99, 102, 241, 0.12), transparent 60%),
        radial-gradient(circle at 90% 90%, rgba(168, 85, 247, 0.12), transparent 60%);
      opacity: 1;
    }

    body::after {
      content: '';
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      opacity: 0.04;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
    }

    .drag-bar {
      position: relative;
      z-index: 10;
      width: 100%;
      height: 44px;
      -webkit-app-region: drag;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.03), transparent);
      backdrop-filter: blur(20px);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      box-sizing: border-box;
      border-bottom: 1px solid var(--glass-border);
    }

    .drag-title {
      font-size: 15px;
      margin: 0;
      font-weight: 600;
      color: var(--text-primary);
      letter-spacing: 0.01em;
    }

    #close-button {
      -webkit-app-region: no-drag;
      width: 28px;
      height: 28px;
      border-radius: 8px;
      border: 1px solid transparent;
      background: var(--button-bg);
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 20px;
      line-height: 1;
      padding: 0;
    }

    #close-button:hover {
      background: var(--danger-color);
      color: white;
      transform: rotate(90deg);
      box-shadow: 0 4px 12px rgba(244, 63, 94, 0.3);
    }

    .wrapper {
      position: relative;
      z-index: 1;
      padding: clamp(16px, 2vw, 24px);
      padding-bottom: clamp(48px, 8vh, 96px);
      overflow-y: auto;
      overflow-x: hidden;
      height: calc(100vh - 44px);
      overscroll-behavior: contain;
    }

    /* Modern custom scrollbar */
    .wrapper::-webkit-scrollbar {
      width: 8px;
    }

    .wrapper::-webkit-scrollbar-track {
      background: transparent;
    }

    .wrapper::-webkit-scrollbar-thumb {
      background: rgba(129, 140, 248, 0.3);
      border-radius: 10px;
      transition: background 0.2s ease;
    }

    .wrapper::-webkit-scrollbar-thumb:hover {
      background: rgba(129, 140, 248, 0.5);
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      display: grid;
      gap: 20px;
      width: 100%;
    }

    .card {
      position: relative;
      background: var(--glass-surface);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg), inset 0 1px 0 var(--glass-highlight);
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 16px;
      min-width: 0;
    }

    .card::before {
      content: '';
      position: absolute;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      background: radial-gradient(circle at 10% 10%, rgba(99, 102, 241, 0.08), transparent 60%),
        radial-gradient(circle at 90% 90%, rgba(168, 85, 247, 0.08), transparent 60%);
      opacity: 1;
      border-radius: var(--radius-lg);
    }

    .hero {
      gap: 12px;
    }

    .title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.02em;
    }

    .subtitle {
      color: var(--text-secondary);
      line-height: 1.6;
      font-size: 15px;
    }

    .links {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
    }

    .btn {
      -webkit-app-region: no-drag;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 18px;
      border-radius: var(--radius-md);
      color: var(--text-primary);
      text-decoration: none;
      border: 1px solid var(--glass-border);
      background: var(--button-bg);
      font-family: 'Outfit', sans-serif;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s ease;
      box-shadow: var(--shadow-sm);
    }

    .btn:hover {
      background: var(--button-hover-bg);
      border-color: var(--accent-primary);
      color: var(--accent-primary);
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(129, 140, 248, 0.2);
    }

    .btn.accent {
      background: rgba(129, 140, 248, 0.1);
      border-color: rgba(129, 140, 248, 0.3);
      color: var(--accent-primary);
    }

    .btn.accent:hover {
      background: rgba(129, 140, 248, 0.2);
      box-shadow: 0 4px 16px var(--accent-glow);
    }

    .btn.primary {
      background: var(--accent-gradient);
      border-color: transparent;
      color: #fff;
      font-weight: 600;
    }

    .btn.primary:hover {
      box-shadow: 0 4px 16px var(--accent-glow);
      transform: translateY(-2px);
    }

    .btn[disabled] {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
      box-shadow: none !important;
      filter: grayscale(1);
    }

    .steps {
      display: grid;
      gap: 16px;
    }

    .step {
      background: var(--item-bg);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-md);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      transition: all 0.2s ease;
      min-width: 0;
    }

    .step:hover {
      background: var(--item-hover-bg);
      border-color: rgba(129, 140, 248, 0.3);
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .step-title {
      font-weight: 600;
      font-size: 16px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .step p {
      margin: 0;
      color: var(--text-secondary);
      font-size: 14px;
      line-height: 1.5;
    }

    /* Code Block Styling */
    .code-wrapper {
      position: relative;
      margin-top: 12px;
      border-radius: var(--radius-md);
      overflow: hidden;
      border: 1px solid var(--glass-border);
      background: rgba(0, 0, 0, 0.3);
    }

    pre {
      margin: 0;
      padding: 16px;
      padding-right: 48px;
      overflow-x: auto;
      border: none;
      background: transparent;
      color: #e8eefc;
      direction: ltr;
      text-align: left;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 13px;
      border-radius: 0;
    }

    /* Custom scrollbar for code blocks */
    pre::-webkit-scrollbar {
      height: 6px;
    }

    pre::-webkit-scrollbar-track {
      background: transparent;
    }

    pre::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
    }

    pre::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    code {
      font-family: inherit;
    }

    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 32px;
      height: 32px;
      border-radius: var(--radius-sm);
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid var(--glass-border);
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 0;
      z-index: 2;
    }

    .copy-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      color: var(--text-primary);
    }

    .copy-btn.copied {
      color: var(--success-color);
      border-color: var(--success-color);
      background: rgba(34, 197, 94, 0.1);
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }

    .chip {
      font-size: 12px;
      padding: 6px 12px;
      border-radius: 999px;
      background: var(--chip-bg);
      color: var(--accent-primary);
      border: 1px solid var(--chip-border);
      font-weight: 500;
    }

    .note {
      font-size: 13px;
      color: var(--text-tertiary);
      margin-top: 8px;
      font-style: italic;
    }

    .status {
      display: none;
      margin-top: 12px;
      font-size: 14px;
      padding: 12px;
      border-radius: var(--radius-md);
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid var(--glass-border);
    }

    .status.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .status.success {
      color: var(--success-color);
      background: rgba(34, 197, 94, 0.1);
      border-color: rgba(34, 197, 94, 0.2);
    }

    .status.error {
      color: var(--danger-color);
      background: rgba(244, 63, 94, 0.1);
      border-color: rgba(244, 63, 94, 0.2);
    }

    .two-col {
      display: grid;
      gap: 20px;
      grid-template-columns: 1fr;
    }

    @media (min-width: 860px) {
      .two-col {
        grid-template-columns: 1fr 1fr;
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Section Headers */
    .section-header {
      font-weight: 600;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent-primary);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
    }
  </style>
</head>

<body>
  <div class="drag-bar">
    <span class="drag-title">MCP SuperAssistant Setup</span>
    <button id="close-button" title="Close">√ó</button>
  </div>

  <div class="wrapper">
    <div class="container">

      <section class="card hero">
        <div class="title">Welcome! What's next?</div>
        <div class="subtitle">
          Enabling "Load MCP SuperAssistant Extension" lets GeminiDesk integrate with MCP SuperAssistant. To
          make it work, run a small local proxy server that bridges the extension to your MCP servers. Set it
          up in minutes:
        </div>
        <div class="links">
          <a class="btn primary" href="#" id="do-it-for-me">‚öôÔ∏è Do it for me</a>
          <a class="btn accent" href="#" id="open-github">üîó Open the GitHub repository</a>
          <a class="btn" href="https://modelcontextprotocol.io/" target="_blank" rel="noopener noreferrer">What is
            MCP?</a>
        </div>
        <div id="auto-setup-status" class="status"></div>
      </section>

      <section class="card steps">
        <div class="section-header">Setup Steps</div>

        <div class="step">
          <div class="step-title">1) Prerequisites</div>
          <p>
            Make sure you have <b>Node.js LTS</b> installed (with npx). <b>pnpm</b> is optional for
            development. Download from: https://nodejs.org/
          </p>
          <div class="chips">
            <span class="chip">Windows PowerShell supported</span>
            <span class="chip">Node.js ‚â• 16</span>
          </div>
        </div>

        <div class="step">
          <div class="step-title">2) Create a config.json</div>
          <p>
            This file declares which MCP servers to run. Example using Desktop Commander via npx:
          </p>
          <div class="code-wrapper">
            <button class="copy-btn" title="Copy">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
            <pre><code>{
  "mcpServers": {
    "desktop-commander": {
      "command": "npx",
      "args": ["-y", "@wonderwhy-er/desktop-commander"]
    }
  }
}</code></pre>
          </div>
          <p class="note">
            Already have a Claude config? You can reuse it here:<br />
            %APPDATA%\Claude\claude_desktop_config.json
          </p>
        </div>

        <div class="step">
          <div class="step-title">3) Start the proxy server</div>
          <p>
            Open PowerShell in the folder containing your config.json and run:
          </p>
          <div class="code-wrapper">
            <button class="copy-btn" title="Copy">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
            <pre><code>npx -y @srbhptl39/mcp-superassistant-proxy@latest --config ./config.json --outputTransport sse</code></pre>
          </div>
          <p class="note">
            Other supported transports:
          </p>
          <div class="code-wrapper">
            <button class="copy-btn" title="Copy">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
            <pre><code># Streamable HTTP
npx -y @srbhptl39/mcp-superassistant-proxy --config ./config.json --outputTransport streamableHttp

# WebSocket
npx -y @srbhptl39/mcp-superassistant-proxy --config ./config.json --outputTransport ws</code></pre>
          </div>
        </div>

        <div class="step two-col">
          <div>
            <div class="step-title">4) Connect from the extension</div>
            <p>
              Open the MCP sidebar in a supported AI site, click the server status indicator and choose
              "Connect". Enter the URL based on the transport you used:
            </p>
            <ul class="note" style="margin: 10px 0; padding-left: 20px;">
              <li>SSE: http://localhost:3006/sse</li>
              <li>Streamable HTTP: http://localhost:3006/mcp</li>
              <li>WebSocket: ws://localhost:3006/message</li>
            </ul>
          </div>
          <div>
            <div class="step-title">Tips</div>
            <ul class="note" style="margin: 10px 0; padding-left: 20px;">
              <li>If it won't connect, ensure the server is running without errors.</li>
              <li>After first run, refresh the tab where the extension is active.</li>
              <li>See the README for more examples and common issues.</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="section-header">Useful links</div>
        <div class="links">
          <a class="btn" href="#" id="open-github-2">GitHub: srbhptl39/MCP-SuperAssistant</a>
          <a class="btn" href="https://github.com/srbhptl39/MCP-SuperAssistant#connecting-to-local-proxy-server"
            target="_blank" rel="noopener noreferrer">Connecting to local proxy</a>
          <a class="btn" href="https://www.youtube.com/watch?v=h9f_GX1Ef20" target="_blank"
            rel="noopener noreferrer">Setup tutorial (YouTube)</a>
        </div>
      </section>

    </div>
  </div>

  <script>
    const closeBtn = document.getElementById('close-button');
    closeBtn.addEventListener('click', () => {
      if (window.close) window.close();
    });

    const openGitHub = () => {
      const url = 'https://github.com/srbhptl39/MCP-SuperAssistant';
      if (window.electronAPI && window.electronAPI.openExternal) {
        window.electronAPI.openExternal(url);
      } else {
        window.open(url, '_blank');
      }
    };

    document.getElementById('open-github').addEventListener('click', (e) => { e.preventDefault(); openGitHub(); });
    document.getElementById('open-github-2').addEventListener('click', (e) => { e.preventDefault(); openGitHub(); });

    // Copy functionality
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', async () => {
        const codeWrapper = btn.closest('.code-wrapper');
        const code = codeWrapper.querySelector('code').innerText;

        // Use Electron's clipboard API
        if (window.electronAPI && window.electronAPI.writeClipboard) {
          try {
            await window.electronAPI.writeClipboard(code);

            // Feedback
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
            btn.classList.add('copied');
            setTimeout(() => {
              btn.innerHTML = originalHTML;
              btn.classList.remove('copied');
            }, 2000);
          } catch (error) {
            console.error('Failed to copy:', error);
          }
        }
      });
    });

    // Do it for me: create config.json and launch proxy
    const doBtn = document.getElementById('do-it-for-me');
    const statusEl = document.getElementById('auto-setup-status');
    const setStatus = (msg, type) => {
      statusEl.textContent = msg;
      statusEl.className = 'status show' + (type ? ' ' + type : '');
    };

    if (doBtn) {
      doBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        if (!window.electronAPI || !window.electronAPI.mcpSetupDoItForMe) {
          setStatus('This action is only available in the desktop app.', 'error');
          return;
        }
        doBtn.setAttribute('disabled', 'true');
        setStatus('Creating config and starting proxy server...', '');
        try {
          const res = await window.electronAPI.mcpSetupDoItForMe();
          if (res && res.success) {
            const url = res.url || 'http://localhost:3006/sse';
            const cfg = res.configPath ? `\nConfig: ${res.configPath}` : '';
            const shellMsg = res.visibleShell ? '\nA PowerShell window was opened to run the server.' : '';
            setStatus(`All set! Connect the extension to: ${url}${cfg}${shellMsg}`, 'success');
          } else {
            const where = res && res.step ? ` (${res.step})` : '';
            setStatus(`Failed to set up${where}: ${res && res.message ? res.message : 'Unknown error'}`, 'error');
            doBtn.removeAttribute('disabled');
          }
        } catch (err) {
          setStatus(`Unexpected error: ${err && err.message ? err.message : err}`, 'error');
          doBtn.removeAttribute('disabled');
        }
      });
    }

    // Theme handling
    if (window.electronAPI && window.electronAPI.theme) {
      window.electronAPI.theme.getResolved().then(theme => {
        if (theme === 'light') document.documentElement.classList.add('light-mode');
        else document.documentElement.classList.remove('light-mode');
      });

      window.electronAPI.theme.onUpdate(theme => {
        if (theme === 'light') document.documentElement.classList.add('light-mode');
        else document.documentElement.classList.remove('light-mode');
      });
    }
  </script>
</body>

</html>